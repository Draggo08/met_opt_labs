# Отчет по лабораторной работе
## Метод ломаных для поиска глобального экстремума

**Автор:** Гельм Даниил

---

## 1. Постановка задачи (общая)

Задача поиска глобального минимума липшицевой функции на отрезке формулируется следующим образом:

Найти точку **x*** ∈ [a, b], которая:

- **Минимизирует** целевую функцию:
  ```
  f(x*) = min_{x ∈ [a, b]} f(x)
  ```

где:
- **f(x)** - липшицева функция одной переменной (т.е. существует константа L > 0 такая, что |f(x₁) - f(x₂)| ≤ L|x₁ - x₂| для всех x₁, x₂ ∈ [a, b])
- **[a, b]** - заданный отрезок
- **eps** - требуемая точность решения

**Цель работы:** Разработать программу, которая решает задачу поиска глобального минимума методом ломаных (методом Пана), выполняет визуализацию процесса решения и выводит результаты: приближенное значение аргумента и минимума, число итераций, затраченное время.

---

## 2. Общий алгоритм решения (блок-схема)

```
НАЧАЛО
  │
  ├─> Ввод функции f(x), отрезка [a, b], точности eps
  │
  ├─> Оценка константы Липшица L:
  │     ├─> Вычисление численной производной в точках отрезка
  │     └─> L = max |f'(x)| * 1.1 (с запасом)
  │
  ├─> Инициализация:
  │     ├─> Вычислить f(a) и f(b)
  │     └─> Добавить точки (a, f(a)) и (b, f(b)) в список точек
  │
  ├─> ИТЕРАЦИЯ:
  │     │
  │     ├─> Построить ломаную функцию:
  │     │     └─> φ(x) = max_i (f(x_i) - L*|x - x_i|)
  │     │     где x_i - точки, в которых уже вычислена функция
  │     │
  │     ├─> Найти точку минимума ломаной:
  │     │     ├─> Для каждой пары соседних точек (x_i, x_{i+1})
  │     │     │     └─> Найти точку пересечения лучей ломаной
  │     │     └─> Выбрать точку с минимальным значением ломаной
  │     │
  │     ├─> Вычислить f(x_new) в найденной точке
  │     │
  │     ├─> Добавить точку (x_new, f(x_new)) в список
  │     │
  │     ├─> Проверка условия остановки:
  │     │     ├─> Оценка погрешности: |f(x_new) - φ(x_new)| < eps?
  │     │     ├─> ДА → ВЫХОД
  │     │     └─> НЕТ → Продолжить итерацию
  │     │
  │     └─> Перейти к следующей итерации
  │
  ├─> Найти минимальное значение функции среди всех вычисленных точек
  │
  ├─> Визуализация:
  │     ├─> График исходной функции f(x)
  │     ├─> График ломаной функции φ(x)
  │     ├─> Отметить вычисленные точки
  │     └─> Отметить найденный минимум
  │
  └─> Вывод результатов:
        ├─> x* - приближенное значение аргумента минимума
        ├─> f(x*) - приближенное значение минимума
        ├─> Число итераций
        └─> Затраченное время
КОНЕЦ
```

---

## 3. Ссылка на программу (репозиторий)

Программа находится в директории `lab2/` и состоит из следующих файлов:

- **`broken_line.py`** - основной модуль с реализацией метода ломаных
- **`function_parser.py`** - парсер для чтения и парсинга функций из строки
- **`visualization.py`** - модуль для визуализации результатов
- **`test_functions.py`** - тестовые функции (Растригина, Экли и др.)
- **`main.py`** - главный файл программы для командной строки
- **`solve_task2.py`** - скрипт для демонстрации работы на тестовых примерах

**Использование:**

1. Через командную строку:
```bash
python main.py "x + sin(3.14159*x)" 0 10 0.01
```

2. Запуск демонстрации:
```bash
python solve_task2.py
```

---

## 4. Демонстрация примеров решения

### Пример 1: Функция Растригина

**Исходная функция:**
```
f(x) = x² - 10·cos(2πx) + 10
```

**Параметры:**
- Отрезок: [-5, 5]
- Точность: 0.01

**Результат выполнения программы:**
```
Функция: f(x) = x^2 - 10*cos(2*pi*x) + 10
Отрезок: [-5.0, 5.0]
Точность: 0.01
Константа Липшица (оценка): 78.419571

✓ Решение найдено!

Приближенное значение аргумента минимума: x* = 0.0000000000
Приближенное значение минимума: f(x*) = 0.0000000000

Число итераций: 175
Затраченное время: 0.405773 секунд
Количество вычисленных точек: 177
Оценка погрешности: 0.0096259906
```

**Проверка:** 
- Аналитически: f(0) = 0² - 10·cos(2π·0) + 10 = 0 - 10·1 + 10 = 0 ✓
- Вычисление: f(0.1) ≈ 1.92, f(1) = 1.0, f(2) = 4.0 - подтверждает, что минимум в нуле

**Анализ:** Функция Растригина имеет глобальный минимум в точке x = 0 со значением f(0) = 0, что подтверждается как аналитически, так и результатами работы программы. Метод ломаных успешно нашел глобальный минимум, несмотря на наличие множества локальных минимумов на отрезке [-5, 5].

### Пример 2: Функция Экли

**Исходная функция:**
```
f(x) = -20·exp(-0.2·√(0.5·x²)) - exp(0.5·cos(2πx)) + e + 20
```

**Параметры:**
- Отрезок: [-5, 5]
- Точность: 0.01

**Результат выполнения программы:**
```
Функция: f(x) = -20*exp(-0.2*sqrt(0.5*x^2)) - exp(0.5*cos(2*pi*x)) + e + 20
Отрезок: [-5.0, 5.0]
Точность: 0.01
Константа Липшица (оценка): 6.898120

✓ Решение найдено!

Приближенное значение аргумента минимума: x* = 0.0000000000
Приближенное значение минимума: f(x*) = 1.0695605578

Число итераций: 19
Затраченное время: 0.000969 секунд
Количество вычисленных точек: 21
Оценка погрешности: 0.0091987649
```

**Анализ:** Функция Экли имеет глобальный минимум в точке x = 0 со значением f(0) ≈ 1.07. Метод ломаных эффективно нашел решение за небольшое число итераций.

### Пример 3: Функция x + sin(3.14159·x)

**Исходная функция:**
```
f(x) = x + sin(3.14159·x)
```

**Параметры:**
- Отрезок: [0, 10]
- Точность: 0.01

**Результат выполнения программы:**
```
Функция: f(x) = x + sin(3.14159*x)
Отрезок: [0.0, 10.0]
Точность: 0.01
Константа Липшица (оценка): 4.555181

✓ Решение найдено!

Приближенное значение аргумента минимума: x* = 0.0000000000
Приближенное значение минимума: f(x*) = 0.0000000000

Число итераций: 13
Затраченное время: 0.000401 секунд
Количество вычисленных точек: 15
Оценка погрешности: 0.0026567141
```

**Анализ:** На отрезке [0, 10] функция имеет несколько локальных минимумов. Метод ломаных нашел глобальный минимум в начале отрезка (x = 0), где f(0) = 0.

---

## 5. Визуализация результатов

Для каждого примера программа генерирует график, который включает:

1. **График исходной функции** (синяя сплошная линия) - показывает поведение функции на всем отрезке
2. **График ломаной функции** (красная пунктирная линия) - нижняя оценка исходной функции
3. **Вычисленные точки** (зеленые точки) - точки, в которых была вычислена функция в процессе работы алгоритма
4. **Найденный минимум** (красная точка с маркером) - приближенное значение аргумента и минимума функции

Графики сохраняются в файлы PNG с высоким разрешением (300 DPI) для включения в отчет.

---

## 6. Заключение

### Что интересного было в данной работе:

1. **Метод ломаных (метод Пана)** - элегантный подход к поиску глобального минимума липшицевой функции. Особенно интересно построение вспомогательной ломаной функции как нижней оценки исходной функции и использование её для выбора следующей точки вычисления.

2. **Оценка константы Липшица** - важный этап алгоритма, от которого зависит эффективность метода. Использование численной оценки производной с запасом обеспечивает корректность работы алгоритма.

3. **Визуализация процесса** - построение графиков ломаной функции позволяет наглядно увидеть, как алгоритм постепенно уточняет оценку минимума и выбирает точки для вычисления.

### Что полезного:

1. **Понимание метода ломаных** - глубокое понимание алгоритма поиска глобального экстремума, включая построение вспомогательных функций и критерии остановки.

2. **Работа с функциями** - практический опыт парсинга математических выражений и безопасного вычисления функций в Python.

3. **Визуализация результатов** - навыки создания информативных графиков с использованием matplotlib для представления результатов численных методов.

4. **Обработка различных функций** - возможность работы с различными типами функций (многоэкстремальные, осциллирующие и т.д.).

### Что бестолкового:

1. **Оценка константы Липшица** - численная оценка константы Липшица может быть неточной, особенно для функций с резкими изменениями производной. В некоторых случаях требуется ручная настройка константы.

2. **Вычислительная сложность** - при большом числе итераций построение ломаной функции становится вычислительно затратным, так как для каждой точки нужно вычислять максимум по всем уже вычисленным точкам.

3. **Требование липшицевости** - метод работает только для липшицевых функций, что ограничивает область его применения. Для функций с разрывами или неограниченной производной метод может работать некорректно.

**Общий вывод:** Работа позволила реализовать и протестировать метод ломаных для поиска глобального минимума. Программа успешно решает задачи на различных тестовых функциях, включая многоэкстремальные функции Растригина и Экли. Визуализация результатов помогает понять процесс работы алгоритма и убедиться в его корректности.

